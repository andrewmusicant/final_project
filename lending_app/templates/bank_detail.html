{% extends 'base.html' %}
{% load static %}

{% block body %}
<h2>{{ bank.name }}</h2>
<div id="table_div"></div>
<div id="pieChart"></div>
{% endblock %}

{% block scripts %}
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load("current", {packages:["corechart", 'table']});
  google.charts.setOnLoadCallback(drawChart);
  function drawChart() {

      var data2 = new google.visualization.DataTable();
      data2.addColumn('number', 'Net Income');
      data2.addColumn('number', 'Total Assets');
      data2.addColumn('number', 'Total Liability');
      data2.addColumn('number', 'ROE');
      data2.addColumn('number', 'Small Loans');
      data2.addColumn('number', 'Micro Loans');
      data2.addColumn('number', 'Farm Loans');
      data2.addColumn('number', 'Total Loans');
      data2.addColumn('number', 'Ind. Amount');
      data2.addColumn('number', 'Small');
      data2.addColumn('number', 'Micro');
      data2.addColumn('number', 'Farm');
      data2.addColumn('number', 'Jar Score');
      data2.addRows([

            [{{ bank.net_income }},
            {{ bank.total_assets }},
            {{ bank.total_liability }},
            {{ bank.return_on_equity }},
            {{ bank.total_num_loans_small }},
            {{ bank.total_num_loans_micro }},
            {{ bank.total_num_loans_farm }},
            {{ bank.total_loans }},
            {{ bank.total_amount_individual }},
            {{ bank.total_amount_small  }},
            {{ bank.total_amount_micro  }},
            {{ bank.total_amount_farm }},
            {{ bank.return_on_equity }}],

  ]);
    var table = new google.visualization.Table(document.getElementById('table_div'));

    table.draw(data2, {
      showRowNumber: false,
      width: '100%',
      height: '100%'
    });
  }
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.4/d3.min.js"></script>
<script src="{% static 'js/d3pie.min.js' %}"></script>
<script>
var pie = new d3pie("pieChart", {
	"header": {
		"title": {
			"text": "Percentages Of Loans for Bank",
			"fontSize": 24,
			"font": "open sans"
		},
		"subtitle": {
			"color": "#999999",
			"fontSize": 12,
			"font": "Josefin sans"
		},
		"titleSubtitlePadding": 9
	},
	"footer": {
		"color": "#999999",
		"fontSize": 10,
		"font": "open sans",
		"location": "bottom-left"
	},
	"size": {
		"canvasWidth": 590,
		"pieOuterRadius": "90%"
	},
	"data": {
		"sortOrder": "value-desc",
		"content": [
			{
				"label": "Small Business Loan",
				"value": ({{bank.small_loan_percentage}}*100),
				"color": "#ff1818"
			},
			{
				"label": "Individual Loan",
				"value": ({{bank.individual_loan_percentage}}*100),
				"color": "#0c6197"
			},
			{
				"label": "Farm Loan",
				"value": ({{bank.farm_loan_percentage}}*100),
				"color": "#4daa4b"
			},
			{
				"label": "Micro Loan",
				"value": ({{bank.micro_loan_percentage}}*100),
				"color": "#effb0c"
			}
		]
	},
	"labels": {
		"outer": {
			"pieDistance": 32
		},
		"inner": {
			"hideWhenLessThanPercentage": 3
		},
		"mainLabel": {
			"fontSize": 11
		},
		"percentage": {
			"color": "#ffffff",
			"decimalPlaces": 0
		},
		"value": {
			"color": "#adadad",
			"fontSize": 11
		},
		"lines": {
			"enabled": true
		},
		"truncation": {
			"enabled": true
		}
	},
	"effects": {
		"pullOutSegmentOnClick": {
			"effect": "linear",
			"speed": 400,
			"size": 8
		}
	},
	"misc": {
		"gradient": {
			"enabled": true,
			"percentage": 100
		}
	}
});
</script>
{% endblock %}
